<mvc:View
    controllerName="refunddetails.controller.RequestDetails"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:core="sap.ui.core"
    displayBlock="true"
    xmlns="sap.m"
    xmlns:smartFilterBar="sap.ui.comp.smartfilterbar"
    xmlns:smartTable="sap.ui.comp.smarttable"
    xmlns:html="http://www.w3.org/1999/xhtml"
    xmlns:app="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1"
    height="100%"
>
    <Page
        id="page"
        class="whiteBackgroundPage"
    >
        <content>
            <Select
                id="mySelect"
                selectedKey="OPTION_VENDER"
                width="30%"
                change="onSelectionChange"
                class="sapUiSmallMarginTop sapUiSmallMarginBottom sapUiSmallMarginBegin"
            >
                <core:Item
                    key="OPTION_VENDER"
                    text="Vendors"
                />
                <core:Item
                    key="OPTION_CUSTOMER"
                    text="Customers"
                />
            </Select>

            <VBox
                fitContainer="true"
                id="vendorsSection"
                visible="true"
            >
                <smartFilterBar:SmartFilterBar
                    id="vendorFilterBar"
                    entitySet="VendorInvSet"
                    persistencyKey="VendorSmartFilter"
                    basicSearchFieldName="Lifnr"
                    enableBasicSearch="true"
                >
                    <smartFilterBar:controlConfiguration>
                        <smartFilterBar:ControlConfiguration
                            key="DateAson"
                            visibleInAdvancedArea="true"
                            mandatory="mandatory"
                            index="0"
                        />
                        <smartFilterBar:ControlConfiguration
                            key="Paval"
                            visibleInAdvancedArea="true"
                        />
                        <smartFilterBar:ControlConfiguration
                            key="Bukrs"
                            visibleInAdvancedArea="true"
                        />
                        <smartFilterBar:ControlConfiguration
                            key="Pspid"
                            visibleInAdvancedArea="true"
                        />
                        <smartFilterBar:ControlConfiguration
                            key="Lifnr"
                            visibleInAdvancedArea="true"
                        />
                    </smartFilterBar:controlConfiguration>
                    <smartFilterBar:layoutData>
                        <FlexItemData shrinkFactor="0" />
                    </smartFilterBar:layoutData>
                </smartFilterBar:SmartFilterBar>
                <smartTable:SmartTable
                    entitySet="VendorInvSet"
                    tableType="ResponsiveTable"
                    smartFilterId="vendorFilterBar"
                    enableExport="true"
                    useVariantManagement="true"
                    useTablePersonalisation="true"
                    header="Vendor List"
                    persistencyKey="VendorSmartTable"
                    enableAutoBinding="true"
                    class="sapUiResponsiveContentPadding" 
                    enableAutoColumnWidth="true"
                    initiallyVisibleFields="Lifnr,TotalAmt,Msme,ApprovalAmt,PayMethod,InvoiceAmt,AdvanceAmt,RetentionAmt,DateAson"
                    beforeRebindTable="onBeforeRebindTable"
                >
                    <Table
                        id="vendorTable"
                        mode="MultiSelect"
                    >
                        <columns>
                            <Column>
                                <customData>
                                    <core:CustomData
                                        key="p13nData"
                                        value='{"columnKey": "Lifnr", "leadingProperty": "Lifnr", "columnIndex": 0, "additionalProperty": "Name1"}'  
                            
                                    />
                                </customData>
                                <Text text="{i18n>VendorName}" />
                            </Column>
                            <Column>
                                <customData>
                                    <core:CustomData
                                        key="p13nData"
                                        value='{"columnKey": "TotalAmt", "leadingProperty": "TotalAmt", "columnIndex": 1}'
                                    />
                                </customData>
                                <Text text="{i18n>TotalAmount}" />
                            </Column>
                            <Column>
                                <customData>
                                    <core:CustomData
                                        key="p13nData"
                                        value='{"columnKey": "Msme", "leadingProperty": "Msme", "columnIndex": 2}'
                                    />
                                </customData>
                                <Text text="{i18n>Msme}" />
                            </Column>
                            <Column>
                                <customData>
                                    <core:CustomData
                                        key="p13nData"
                                        value='{"columnKey": "ApprovalAmt", "leadingProperty": "ApprovalAmt", "columnIndex": 3}'
                                    />
                                </customData>
                                <Text text="{i18n>ApprovalAmount}" />
                            </Column>
                            <Column>
                                <customData>
                                    <core:CustomData
                                        key="p13nData"
                                        value='{"columnKey": "PayMethod", "leadingProperty": "PayMethod", "columnIndex": 4}'
                                    />
                                </customData>
                                <Text text="{i18n>PaymentMethod}" />
                            </Column>
                            <Column>
                                <customData>
                                    <core:CustomData
                                        key="p13nData"
                                        value='{"columnKey": "InvoiceAmt", "leadingProperty": "InvoiceAmt", "columnIndex": 5}'
                                    />
                                </customData>
                                <Text text="{i18n>InvoiceAmount}" />
                            </Column>
                            <Column>
                                <customData>
                                    <core:CustomData
                                        key="p13nData"
                                        value='{"columnKey": "AdvanceAmt", "leadingProperty": "AdvanceAmt", "columnIndex": 6}'
                                    />
                                </customData>
                                <Text text="{i18n>AdvanceAmount}" />
                            </Column>
                            <Column>
                                <customData>
                                    <core:CustomData
                                        key="p13nData"
                                        value='{"columnKey": "RetentionAmt", "leadingProperty": "RetentionAmt", "columnIndex": 7}'
                                    />
                                </customData>
                                <Text text="{i18n>RetentionAmount}" />
                            </Column>
                            <Column>
                                <customData>
                                    <core:CustomData
                                        key="p13nData"
                                        value='{"columnKey": "DateAson", "leadingProperty": "DateAson", "columnIndex": 8}'
                                    />
                                </customData>
                            </Column>
                        </columns>

                        <items>
                            <ColumnListItem>
                                <cells>
                                                            
                                    <Text text="{= ${Lifnr} + ' - ' + ${Name1} }" />
                                    <Text text="{TotalAmt}" />
                                    <Text text="{Msme}" />
                                    <Text text="{ApprovalAmt}" />
                                    <Button
                                        icon="sap-icon://action"
                                        text=""
                                        press=".onPayMethodPress"
                                    />
                                    <Text text="{InvoiceAmt}" />
                                    <Text text="{AdvanceAmt}" />
                                    <Text text="{RetentionAmt}" />
                                </cells>
                            </ColumnListItem>
                        </items>
                    </Table>

                    <smartTable:layoutData>
                        <FlexItemData
                            growFactor="1"
                            baseSize="0%"
                        />
                    </smartTable:layoutData>
                </smartTable:SmartTable>
            </VBox>

            <VBox
                fitContainer="true"
                id="customersSection"
                visible="false"
            >
                <smartFilterBar:SmartFilterBar
                    id="customerFilterBar"
                    entitySet="CustomerRetSet"
                    persistencyKey="CustomerSmartFilter"
                    basicSearchFieldName="Bukrs"
                    enableBasicSearch="true"
                >
                    <smartFilterBar:controlConfiguration>
                        <smartFilterBar:ControlConfiguration
                            key="DateAson"
                            visibleInAdvancedArea="true"
                            mandatory="mandatory"
                            index="0"
                        />
                        <smartFilterBar:ControlConfiguration
                            key="Paval"
                            visibleInAdvancedArea="true"
                        />
                        <smartFilterBar:ControlConfiguration
                            key="Bukrs"
                            visibleInAdvancedArea="true"
                        />
                        <smartFilterBar:ControlConfiguration
                            key="Pspid"
                            visibleInAdvancedArea="true"
                        />
                        <smartFilterBar:ControlConfiguration
                            key="Kunnr"
                            visibleInAdvancedArea="true"
                        />
                    </smartFilterBar:controlConfiguration>
                    <smartFilterBar:layoutData>
                        <FlexItemData shrinkFactor="0" />
                    </smartFilterBar:layoutData>
                </smartFilterBar:SmartFilterBar>
                <smartTable:SmartTable
                    entitySet="CustomerRetSet"
                    tableType="ResponsiveTable"
                    smartFilterId="customerFilterBar"
                    enableExport="true"
                    useVariantManagement="true"
                    useTablePersonalisation="true"
                    header="Customer List"
                    persistencyKey="CustomerSmartTable"
                    enableAutoBinding="true"
                    class="sapUiResponsiveContentPadding"
                    ignoreFromPersonalisation="Bankl,Paval,Bukrs,DateAson,Gjahr,Buzei,PayMethod,Pspid,ProjectName,RequestNo"
                    enableAutoColumnWidth="true"
                    initiallyVisibleFields="Kunnr,Name1,Project,UnitNo,Docnr,Budat,TotalAmt,ApprovalAmt"
                >
                    <Table
                        id="customerTable"
                        mode="MultiSelect"
                    >
                        <columns>
                            <Column>
                                <customData>
                                    <core:CustomData
                                        key="p13nData"
                                        value='{"columnKey": "Kunnr", "leadingProperty": "Kunnr", "columnIndex": 0}'
                                    />
                                </customData>
                                <Text text="{i18n>CustomerName}" />
                            </Column>
                            <Column>
                                <customData>
                                    <core:CustomData
                                        key="p13nData"
                                        value='{"columnKey": "Name1", "leadingProperty": "Name1", "columnIndex": 1}'
                                    />
                                </customData>
                                <Text text="{i18n>Name}" />
                            </Column>
                            <Column>
                                <customData>
                                    <core:CustomData
                                        key="p13nData"
                                        value='{"columnKey": "Project", "leadingProperty": "Project", "columnIndex": 2}'
                                    />
                                </customData>
                                <Text text="{i18n>Project}" />
                            </Column>
                            <Column>
                                <customData>
                                    <core:CustomData
                                        key="p13nData"
                                        value='{"columnKey": "UnitNo", "leadingProperty": "UnitNo", "columnIndex": 3}'
                                    />
                                </customData>
                                <Text text="{i18n>UnitNo}" />
                            </Column>
                            <Column>
                                <customData>
                                    <core:CustomData
                                        key="p13nData"
                                        value='{"columnKey": "Docnr", "leadingProperty": "Docnr", "columnIndex": 4}'
                                    />
                                </customData>
                                <Text text="{i18n>Docnr}" />
                            </Column>
                            <Column>
                                <customData>
                                    <core:CustomData
                                        key="p13nData"
                                        value='{"columnKey": "Budat", "leadingProperty": "Budat", "columnIndex": 5}'
                                    />
                                </customData>
                                <Text text="{i18n>Budat}" />
                            </Column>
                            <Column>
                                <customData>
                                    <core:CustomData
                                        key="p13nData"
                                        value='{"columnKey": "TotalAmt", "leadingProperty": "TotalAmt", "columnIndex": 6}'
                                    />
                                </customData>
                                <Text text="{i18n>TotalAmount}" />
                            </Column>

                            <Column>
                                <customData>
                                    <core:CustomData
                                        key="p13nData"
                                        value='{"columnKey": "FullPayment", "leadingProperty": "", "visible": true,"columnIndex": 7}'
                                    />
                                </customData>
                                <header>
                                    <Text text="{i18n>FullPayment}" />
                                </header>
                            </Column>

                            <Column>
                                <customData>
                                    <core:CustomData
                                        key="p13nData"
                                        value='{"columnKey": "ApprovalAmt", "leadingProperty": "ApprovalAmt", "columnIndex": 8, 
                            "additionalProperty": "Bukrs,DateAson,Pspid ,Paval,ProjectName,Gjahr,PayMethod,Bankl,Buzei"}'
                                    />
                                </customData>
                                <Text text="{i18n>ApprovalAmt}" />
                            </Column>
                        </columns>

                        <items>
                            <ColumnListItem>
                                <cells>
                                    <Text text="{Kunnr}" />
                                    <Text text="{Name1}" />
                                    <Text text="{Project}" />
                                    <Text text="{UnitNo}" />
                                    <Text text="{Docnr}" />
                                    <Text
                                        text="{path:'Budat',formatter:'.formatDate'}"
                                    />
                                    <Text text="{TotalAmt}" />
                                    <CheckBox select=".onCheckboxSelect1" />
                                    <Input
                                        value="{ApprovalAmt}"
                                        editable="true"
                                        placeholder="Enter amount"
                                        liveChange=".onQtyLiveChange"
                                        valueLiveUpdate="true"
                                    />
                                </cells>
                            </ColumnListItem>
                        </items>
                    </Table>

                    <smartTable:layoutData>
                        <FlexItemData
                            growFactor="1"
                            baseSize="0%"
                        />
                    </smartTable:layoutData>
                </smartTable:SmartTable>
            </VBox>
        </content>

        <footer>
            <Toolbar>
                <ToolbarSpacer />
                <Button
                    type="Emphasized"
                    text="Submit"
                    press="onSubmitPress"
                />
                <Button
                    text="Cancel"
                    type="Reject"
                    press="onCancelPress"
                />
            </Toolbar>
        </footer>
    </Page>
</mvc:View>
